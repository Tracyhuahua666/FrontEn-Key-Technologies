# 一、 权限相关概念
## 1.1 权限的分类
### 后端权限
前端仅仅只是视图层的展示， 权限的核心是在于服务器中的数据变，所以后端才是权限的关键，后端权限可以控制某个用户是否能够查询数据，是否能够修改数据等操作
### 后端如何知道该请求是哪个用户发过来的
```
cookie
session
token
```
### 后端的权限设计RBAC
用户
角色
权限
### 前端权限
前端权限的控制本质上来说，就是控制端的视图层的展示和前端所发送的请求。但是只有前端权限控制没有后端权限控制是万万不可的。前端权限控制只可以说是达到锦上添花的效果。

### 1.2 前端权限的意义
如果仅从能够修改服务器中数据库中的数据层面上讲， 确实只在后端做控制就足够了， 那为什么越来越多的项目也进行了前端权限的控制， 主要有这几方面的好处:

1.  降低非法操作的可能性
>>不怕赃偷就怕贼惦记，在页面中展示出一个就算点击了也最终会失败的按钮，势必会增加有心者非法操作的可能性
2.  尽可能排除不必要清求，减轻服务器压力
>>没必要的请求，操作失败的清求，不具备权限的清求，应该压根就不需要发送，请求少了，自然也会减轻服务器的压力
3.  提高用户体验
>>根据用户具备的权限为该用户展现自己权限范围内的内容， 避免在界面上给用户带来困扰，让用户专注于分内之事
# 二、 前端权限控制思路
## 2.1 菜单的控制
在登录请求返回里，得到与后端商定的权限数据，前端根据权限数据，展示对应的菜单,点击菜单，才能查看相关的界面


## 2.2 界面的控制
如果用户没有登录，手动在地址栏敲入非登录界面的地址，则需要跳转到登录界面

如果用户已经登录，如果手动敲入非权限内的地址，则需要跳转到404页面，并提示用户没有访问权限

## 2.3 按钮的控制
在某个菜单的界面中，还得根据权限数据， 展示出可进行操作的按钮，比如删除，修改，增加

## 2.4 请求和响应的控制
如果用户通过非常规操作，比如通过浏览器调试工具将某些禁用的按钮变成启用状态， 此时发的请求，也应该被前端所拦截
# 三:具体实现
## 3.1 菜单控制
前端发请求带上用户标识token和角色，后端根据用户角色对应的权限，返回不同的菜单。
## 3.2 界面的控制
### 登录检测：
axios请求拦截：

第一次登录后，用sessionStorge保存token。并每次发请求前，通过axios路由拦截把token放到请求头的Authorization字段中。

vue-router路由拦截：

在非登录页面跳转之前，查看缓存中是否有token，若有则放行，若没有，则跳转到登录页
### 3.2页面访问权限检测
vue-router路由元信息（meta）
如果用户已经登录，如果手动敲入地址，则需要通过查看用户的角色是否在meta的角色权限列表中，若是，则可以访问，若不是，需要跳转到404页面，并提示用户没有访问权限

### 3.3 按钮的控制
对于某些详情页，后端根据用户角色，返回对于的权限数组，前端根据权限数组的内容，展示对于的按钮。
例如：right:['edit','delete']，前端就可以根据right数组的这段展示编辑和删除按钮，不展示新增按钮

### 3.4 访问控制
在发送请求之前，校验前端角色是否有权限，没有则拦截请求，提醒用户没有权限，跳转到登录页
